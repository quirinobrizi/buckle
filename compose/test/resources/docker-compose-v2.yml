version: '2.2'

services:
  foo:
    image: busybox
    depends_on:
        - microservice_1
    blkio_config:
      weight: 300
      weight_device:
        - path: /dev/sda
          weight: 400
      device_read_bps:
        - path: /dev/sdb
          rate: '12mb'
      device_read_iops:
        - path: /dev/sdb
          rate: 120
      device_write_bps:
        - path: /dev/sdb
          rate: '1024k'
      device_write_iops:
        - path: /dev/sdb
          rate: 30
  microservice_1:
    restart: always
    image: busybox
    environment:
      SPRING_CLOUD_CONFIG_ENABLED: "true"
      EUREKA_CLIENT_ENABLED: "true"
    labels:
      - org.buckle.cluster=microservice
    expose:
      - 8080
    networks:
      backend:
      frontend:
        aliases:
            - ms1

volumes:
  data:
    external: true
    name: my-app-data

networks:
    frontend:
        external: true
    backend:
        external: true
